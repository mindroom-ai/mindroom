---
# Authelia configuration
# https://www.authelia.com/configuration/prologue/introduction/

# Server configuration
server:
  host: 0.0.0.0
  port: 9091

# Log level
log:
  level: info

# Theme (light, dark, grey, auto)
theme: auto

# JWT Secret - CHANGE THIS! Generate with: openssl rand -hex 32
jwt_secret: CHANGE_THIS_TO_A_RANDOM_SECRET_USE_OPENSSL_RAND_HEX_32

# Default redirection URL
default_redirection_url: https://mindroom.localhost

# TOTP Configuration for 2FA
totp:
  issuer: authelia.com
  period: 30
  skew: 1

# Authentication backend - file-based for simplicity
# Users are defined in users_database.yml
authentication_backend:
  file:
    path: /config/users_database.yml
    password:
      algorithm: argon2id
      iterations: 1
      memory: 1024
      parallelism: 8
      key_length: 32
      salt_length: 16

# Access Control - who can access what
access_control:
  default_policy: deny
  rules:
    # Allow access to Authelia itself
    - domain: auth.*.localhost
      policy: bypass

    # Require authentication for all mindroom instances
    - domain: '*.localhost'
      policy: one_factor

    # For production domains
    - domain: '*.yourdomain.com'
      policy: two_factor

# Session configuration
session:
  name: authelia_session
  # Generate with: openssl rand -hex 32
  secret: CHANGE_THIS_TO_A_RANDOM_SECRET_USE_OPENSSL_RAND_HEX_32
  expiration: 1h
  inactivity: 5m
  remember_me_duration: 1M

  redis:
    host: authelia-redis
    port: 6379

# Regulation - prevent brute force
regulation:
  max_retries: 3
  find_time: 2m
  ban_time: 5m

# Storage for user preferences and 2FA
storage:
  local:
    path: /config/db.sqlite3

# Notifier for password reset (start with filesystem for testing)
notifier:
  disable_startup_check: false
  filesystem:
    filename: /config/notification.txt

  # For production, use SMTP:
  # smtp:
  #   host: smtp.gmail.com
  #   port: 587
  #   username: your-email@gmail.com
  #   password: your-app-password
  #   sender: "Authelia <your-email@gmail.com>"
  #   subject: "[Authelia] {title}"

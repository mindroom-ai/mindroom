# ============================================================================
# MindRoom SaaS Infrastructure Configuration
# ============================================================================
#
# Copy this file to terraform.tfvars and fill in your actual values.
#
# IMPORTANT: Never commit terraform.tfvars to version control!
#            It contains sensitive credentials.
# ============================================================================

# ===========================================
# REQUIRED: Hetzner Cloud Configuration
# ===========================================

# Get your API token from: https://console.hetzner.cloud/
# Project → Security → API Tokens → Generate API Token
# Required scopes: Read & Write
hcloud_token = "YOUR_HETZNER_API_TOKEN"

# ===========================================
# REQUIRED: External Service Credentials
# ===========================================

# Supabase Configuration (https://supabase.com)
# Get from: Project Settings → API
supabase_url         = "https://YOUR_PROJECT.supabase.co"
supabase_anon_key    = "eyJ..."  # Your anon/public key
supabase_service_key = "eyJ..."  # Your service_role/secret key

# Stripe Configuration (https://stripe.com)
# Get from: Dashboard → Developers → API keys
stripe_secret_key    = "sk_live_..."  # Or sk_test_ for testing
stripe_webhook_secret = "whsec_..."    # From Webhooks → Signing secret

# ===========================================
# OPTIONAL: DNS Automation (Porkbun)
# ===========================================
# Leave empty to skip automatic DNS configuration

# Get from: https://porkbun.com/account/api
# 1. Enable API access for your domain
# 2. Generate API key pair
porkbun_api_key    = ""  # e.g., "pk1_..."
porkbun_secret_key = ""  # e.g., "sk1_..."

# ===========================================
# OPTIONAL: Infrastructure Customization
# ===========================================

# Environment name (used for resource naming)
environment = "production"  # or "staging", "dev"

# Your domain name
domain = "mindroom.chat"  # Change to your domain

# Server location (Hetzner datacenter)
# Options: nbg1 (Nuremberg), fsn1 (Falkenstein), hel1 (Helsinki), ash (Ashburn), hil (Hillsboro)
location = "nbg1"  # Nuremberg, Germany (good for EU/US)

# Server types (see: https://www.hetzner.com/cloud)
# CPX11: 2 vCPU, 2GB RAM (~€4/mo)
# CPX21: 3 vCPU, 4GB RAM (~€8/mo)
# CPX31: 4 vCPU, 8GB RAM (~€16/mo)
# CPX41: 8 vCPU, 16GB RAM (~€32/mo)
# CPX51: 16 vCPU, 32GB RAM (~€65/mo)
dokku_server_type    = "cpx31"  # For customer instances (default: 4 vCPU, 8GB RAM)
platform_server_type = "cpx21"  # For platform services (default: 3 vCPU, 4GB RAM)

# Storage volumes (in GB)
dokku_volume_size    = 200  # Storage for customer instances
platform_volume_size = 50   # Storage for platform services

# Enable automatic backups (adds ~20% to server cost)
enable_backups = true

# Dokku version to install
dokku_version = "v0.32.3"  # Latest stable as of 2024

# ===========================================
# OPTIONAL: Security Configuration
# ===========================================

# List of IP addresses allowed to SSH into servers
# Use ["0.0.0.0/0", "::/0"] to allow from anywhere (not recommended for production)
admin_ips = [
  "YOUR.HOME.IP.ADDRESS/32",     # Your home IP
  "YOUR.OFFICE.IP.ADDRESS/32",   # Your office IP
  "0.0.0.0/0",                    # WARNING: Allows SSH from anywhere (remove in production!)
  "::/0"                          # WARNING: Allows SSH from anywhere IPv6 (remove in production!)
]

# SSH key paths (uses your default key if not changed)
ssh_public_key_path = "~/.ssh/id_rsa.pub"  # Your SSH public key for server access

# Dokku provisioner keys (auto-generated if not exists)
dokku_provisioner_key_path         = "ssh/dokku_provisioner.pub"
dokku_provisioner_private_key_path = "ssh/dokku_provisioner"

# ===========================================
# OPTIONAL: Feature Flags
# ===========================================

# Enable Matrix federation DNS records (*.m.domain)
enable_matrix_federation = true

# Enable email-related DNS records (MX, SPF)
enable_email = false

# Mail server for MX records (only if enable_email = true)
mx_server = "mail.example.com"

# ============================================================================
# QUICK START CHECKLIST:
# ============================================================================
#
# 1. [ ] Copy this file to terraform.tfvars
# 2. [ ] Set hcloud_token (required)
# 3. [ ] Set Supabase credentials (required)
# 4. [ ] Set Stripe credentials (required)
# 5. [ ] Set your domain name
# 6. [ ] (Optional) Set Porkbun API keys for automatic DNS
# 7. [ ] (Optional) Restrict admin_ips to your IP addresses
# 8. [ ] (Optional) Adjust server sizes based on expected load
#
# Then run:
#   terraform init      # Download providers
#   terraform plan      # Preview changes
#   terraform apply     # Create infrastructure
#
# ============================================================================

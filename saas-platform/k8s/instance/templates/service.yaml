---
apiVersion: v1
kind: Service
metadata:
  name: mindroom-frontend-{{ .Values.customer }}
  namespace: mindroom-instances
  labels:
    app: mindroom-frontend
    customer: {{ .Values.customer | quote }}
spec:
  type: ClusterIP
  ports:
  - port: 3003
    targetPort: 80  # Now targets nginx auth proxy
    name: http
  - port: 8765
    targetPort: 8765  # Backend API in frontend container
    name: backend
  selector:
    app: mindroom-frontend
    customer: {{ .Values.customer | quote }}
# mindroom-backend doesn't need a service - it's a Matrix bot, not an API server
---
apiVersion: v1
kind: Service
metadata:
  name: synapse-{{ .Values.customer }}
  namespace: mindroom-instances
  labels:
    app: synapse
    customer: {{ .Values.customer | quote }}
spec:
  type: ClusterIP
  ports:
  - port: 8008
    targetPort: 8008
    name: http
  selector:
    app: synapse
    customer: {{ .Values.customer | quote }}
